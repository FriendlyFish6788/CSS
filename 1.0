#The Code to find Cyclic Sum Sets given the order of n

#Necessary Imports for code
import itertools
import timeit

#The start of a timer for problem number 16
start = timeit.default_timer()

#Getting order for N and number of Terms
#N = int(input("enter order of CSS: "))
N = 7
n = N*N + N + 1
terms = N + 1
potentCSS = set()
permUnsort = []
permList = []
cssList = []

#Code borrowed from Jerome Kelleher to generate partitions efficiently
def accelAsc(n):
    a = [0 for i in range(n + 1)]
    k = 1
    y = n - 1
    while k != 0:
        x = a[k - 1] + 1
        k -= 1
        while 2*x <= y:
            a[k] = x
            y -= x
            k += 1
        l = k + 1
        while x <= y:
            a[k] = x
            a[l] = y
            yield a[:k + 2]
            x += 1
            y -= 1
        a[k] = x + y
        y = x + y - 1
        yield a[:k + 1]
part = accelAsc(n)
#Checking through the partitions to check the CSS properties
for i in part:
    if (len(i) == terms) and (1 in i) and (2 in i):
        potentCSS.add(tuple(sorted(i)))
potCSS = list(potentCSS)

#Checking for Duplicates
filtered = potCSS[:]
for x in potCSS:
    seen = []
    for i in x:
        if i in seen:
            if x in filtered:
                filtered.remove(x)
        seen.append(i)
filtPotCSS = filtered

#Permutating the Duplicates
for i in filtPotCSS:
    permList.append(list(itertools.permutations(i, len(i))))

perms = permList

#Code that checks for CSS property. Borrowed from zdobrenen
def isCSS(L):
    seen = []
    n = len(L)
    for i in range(1,n):
        for start in range(0,n):
            Sum = 0
            for j in range(0,i):
                Sum = Sum + L[(start + j)%n]
            if Sum in seen:
                return False
            seen.append(Sum)
    return True

#Checks the potential orientations for if they are a CSS
for listPerms in perms:
    for j in listPerms:
        if isCSS(j) == True:
            css = []
            css.append(j)
            cssList.append(css)

#Prints out the final CSS
for i in cssList:
    print(i)
stop = timeit.default_timer()
print(stop - start)
